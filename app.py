import streamlit as st
import requests

# Ð’Ð¡Ð¢ÐÐ’Ð¬Ð¢Ð• Ð¡Ð®Ð”Ð Ð’ÐÐ¨Ð£ Ð¡Ð¡Ð«Ð›ÐšÐ£ /exec
SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxI233LLqpJV1AhaeYZsnihmsp3i_OyGGHZDUvGKzcz-Q7DRSL7zvlYDBRpdUmCaQes/exec" 

st.set_page_config(page_title="Idea.bkz", layout="centered")

st.title("Idea.bkz")
st.caption("ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ð¹ ÑÐ²ÑÐ·Ð¸ (7 ÐºÐ»Ð°ÑÑ)")

# --- Ð’Ñ‹Ð±Ð¾Ñ€ Ñ€Ð°Ð·Ð´ÐµÐ»Ð° ---
col1, col2 = st.columns(2)
if "section" not in st.session_state:
    st.session_state.section = "TEST"

with col1:
    if st.button("ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¢Ð•Ð¡Ð¢"):
        st.session_state.section = "TEST"
with col2:
    if st.button("ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÐžÐ¢ÐšÐ Ð«Ð¢Ð«Ð• Ð’ÐžÐŸÐ ÐžÐ¡Ð«"):
        st.session_state.section = "OPEN"

st.divider()

st.subheader("Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ°")
name = st.text_input("Ð¤Ð˜Ðž ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ°", placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½")
klass = st.text_input("ÐšÐ»Ð°ÑÑ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: 7Ð)", placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: 7Ð")

st.divider()

# ---------- ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ ----------
def comment_by_score(score: int) -> str:
    if score <= 3:
        return "ÐÐ¸Ð·ÐºÐ¸Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚. ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸ Ñ‚ÐµÐ¼Ñƒ Ð¿Ð¾ ÐºÐ¾Ð½ÑÐ¿ÐµÐºÑ‚Ñƒ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²Ð¾Ñ‡Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ. ÐÐ° ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¼ ÑƒÑ€Ð¾ÐºÐµ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ð¼ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ðµ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ñ‹."
    if score <= 6:
        return "Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ. Ð•ÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹ â€” Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, Ð·Ð°Ñ‚ÐµÐ¼ Ð¿Ñ€Ð¾Ñ€ÐµÑˆÐ°Ð¹ ÐµÑ‰Ñ‘ 5â€“7 Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²."
    if score <= 8:
        return "Ð¥Ð¾Ñ€Ð¾ÑˆÐ¸Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚. ÐžÑÑ‚Ð°Ð»Ð¾ÑÑŒ Ð·Ð°ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ð´ÐµÑ‚Ð°Ð»Ð¸ â€” Ð¾Ð±Ñ€Ð°Ñ‚Ð¸ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð½Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð¸ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ñ‹."
    return "ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾! Ð¢ÐµÐ¼Ð° ÑƒÑÐ²Ð¾ÐµÐ½Ð°. ÐœÐ¾Ð¶Ð½Ð¾ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ðº Ð·Ð°Ð´Ð°Ð½Ð¸ÑÐ¼ Ð¿Ð¾Ð²Ñ‹ÑˆÐµÐ½Ð½Ð¾Ð¹ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸."

# ---------- TEST (10 Ð±Ð°Ð»Ð»Ð¾Ð²) ----------
test_questions = [
    ("Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ð¾Ñ€Ð³Ð°Ð½ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ñ Ñƒ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°:", ["ÐŸÐ¾Ñ‡ÐºÐ¸", "ÐŸÐµÑ‡ÐµÐ½ÑŒ", "Ð›Ñ‘Ð³ÐºÐ¸Ðµ"], "ÐŸÐ¾Ñ‡ÐºÐ¸"),
    ("Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ð°Ñ ÐµÐ´Ð¸Ð½Ð¸Ñ†Ð° Ð¿Ð¾Ñ‡ÐºÐ¸:", ["ÐÐµÑ„Ñ€Ð¾Ð½", "ÐÐ»ÑŒÐ²ÐµÐ¾Ð»Ð°", "ÐÐµÐ¹Ñ€Ð¾Ð½"], "ÐÐµÑ„Ñ€Ð¾Ð½"),
    ("Ð“Ð´Ðµ Ð¾Ð±Ñ€Ð°Ð·ÑƒÐµÑ‚ÑÑ Ð¼Ð¾Ñ‡Ð° (Ð¿ÐµÑ€Ð²Ð¸Ñ‡Ð½Ð°Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ)?", ["Ð’ ÐºÐ»ÑƒÐ±Ð¾Ñ‡ÐºÐ°Ñ… Ð½ÐµÑ„Ñ€Ð¾Ð½Ð°", "Ð’ Ð¶ÐµÐ»ÑƒÐ´ÐºÐµ", "Ð’ Ð¿ÐµÑ‡ÐµÐ½Ð¸"], "Ð’ ÐºÐ»ÑƒÐ±Ð¾Ñ‡ÐºÐ°Ñ… Ð½ÐµÑ„Ñ€Ð¾Ð½Ð°"),
    ("Ð§Ñ‚Ð¾ Ð²Ñ‹Ð²Ð¾Ð´ÑÑ‚ Ð¿Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ð¶ÐµÐ»ÐµÐ·Ñ‹?", ["Ð’Ð¾Ð´Ð°, ÑÐ¾Ð»Ð¸, Ð¼Ð¾Ñ‡ÐµÐ²Ð¸Ð½Ð°", "ÐšÐ¸ÑÐ»Ð¾Ñ€Ð¾Ð´", "Ð–Ñ‘Ð»Ñ‡ÑŒ"], "Ð’Ð¾Ð´Ð°, ÑÐ¾Ð»Ð¸, Ð¼Ð¾Ñ‡ÐµÐ²Ð¸Ð½Ð°"),
    ("ÐšÐ°ÐºÐ¾Ð¹ Ð¾Ñ€Ð³Ð°Ð½ ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑ‚ Ð² Ð²Ñ‹Ð²ÐµÐ´ÐµÐ½Ð¸Ð¸ COâ‚‚?", ["Ð›Ñ‘Ð³ÐºÐ¸Ðµ", "ÐŸÐ¾Ñ‡ÐºÐ¸", "ÐŸÐ¾Ð´Ð¶ÐµÐ»ÑƒÐ´Ð¾Ñ‡Ð½Ð°Ñ"], "Ð›Ñ‘Ð³ÐºÐ¸Ðµ"),
    ("Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ñ:", ["Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ð¾Ð±Ð¼ÐµÐ½Ð°", "Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ñ€Ð¾ÑÑ‚ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð¼Ð°", "ÐžÐ±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÑ€Ð¾Ð²Ð¸"], "Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ð¾Ð±Ð¼ÐµÐ½Ð°"),
    ("ÐšÐ°Ðº Ð½Ð°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ñ‚Ñ€ÑƒÐ±Ð¾Ñ‡ÐºÐ° Ð½ÐµÑ„Ñ€Ð¾Ð½Ð°?", ["ÐšÐ°Ð½Ð°Ð»ÑŒÑ†Ñ‹", "ÐÐ¾Ñ€Ñ‚Ð°", "Ð¢Ñ€Ð°Ñ…ÐµÑ"], "ÐšÐ°Ð½Ð°Ð»ÑŒÑ†Ñ‹"),
    ("Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ð¼Ð¾Ñ‡ÐµÐ²Ð¸Ð½Ð°?", ["ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚ Ð¾Ð±Ð¼ÐµÐ½Ð° Ð±ÐµÐ»ÐºÐ¾Ð²", "Ð’Ð¸Ñ‚Ð°Ð¼Ð¸Ð½", "Ð“Ð¾Ñ€Ð¼Ð¾Ð½"], "ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚ Ð¾Ð±Ð¼ÐµÐ½Ð° Ð±ÐµÐ»ÐºÐ¾Ð²"),
    ("ÐšÐ°ÐºÐ°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° ÑÐ²ÑÐ·Ð°Ð½Ð° Ñ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸ÐµÐ¼ Ñ‡ÐµÑ€ÐµÐ· ÐºÐ¾Ð¶Ñƒ?", ["ÐŸÐ¾ÐºÑ€Ð¾Ð²Ð½Ð°Ñ", "ÐÐµÑ€Ð²Ð½Ð°Ñ", "ÐžÐ¿Ð¾Ñ€Ð½Ð¾-Ð´Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ"], "ÐŸÐ¾ÐºÑ€Ð¾Ð²Ð½Ð°Ñ"),
    ("ÐšÐ°ÐºÐ¾Ð¹ Ð¾Ñ€Ð³Ð°Ð½ Ð²Ñ‹Ð´ÐµÐ»ÑÐµÑ‚ Ð¶Ñ‘Ð»Ñ‡Ð½Ñ‹Ðµ Ð¿Ð¸Ð³Ð¼ÐµÐ½Ñ‚Ñ‹?", ["ÐŸÐµÑ‡ÐµÐ½ÑŒ", "ÐŸÐ¾Ñ‡ÐºÐ¸", "Ð¡ÐµÑ€Ð´Ñ†Ðµ"], "ÐŸÐµÑ‡ÐµÐ½ÑŒ"),
]

def render_test():
    st.header("ðŸŸ¦ Ð Ð°Ð·Ð´ÐµÐ»: Ð¢Ð•Ð¡Ð¢")
    st.caption("Ð¢ÐµÐ¼Ð°: Ð’Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ. 10 Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² = 10 Ð±Ð°Ð»Ð»Ð¾Ð².")

    answers = []
    score = 0

    for i, (q, options, correct) in enumerate(test_questions, start=1):
        ans = st.radio(f"{i}. {q}", options, index=None, key=f"t{i}")
        answers.append(ans if ans else "")
        if ans == correct:
            score += 1

    return answers, score

# ---------- OPEN (10 Ð±Ð°Ð»Ð»Ð¾Ð²) ----------
open_questions = [
    "1) ÐžÐ±ÑŠÑÑÐ½Ð¸, Ð·Ð°Ñ‡ÐµÐ¼ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð¼Ñƒ Ð½ÑƒÐ¶Ð½Ð° ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ñ (2â€“3 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ).",
    "2) ÐžÐ¿Ð¸ÑˆÐ¸ Ð¿ÑƒÑ‚ÑŒ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¼Ð¾Ñ‡Ð¸ (ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð¿Ð¾ ÑÑ‚Ð°Ð¿Ð°Ð¼).",
    "3) ÐšÐ°ÐºÐ¸Ðµ Ð²ÐµÑ‰ÐµÑÑ‚Ð²Ð° Ð²Ñ‹Ð²Ð¾Ð´ÑÑ‚ Ð¿Ð¾Ñ‡ÐºÐ¸? ÐŸÑ€Ð¸Ð²ÐµÐ´Ð¸ 3 Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°.",
    "4) ÐšÐ°Ðº ÐºÐ¾Ð¶Ð° ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑ‚ Ð² Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ð¸? ÐšÐ°ÐºÐ¸Ðµ Ð²ÐµÑ‰ÐµÑÑ‚Ð²Ð° Ð²Ñ‹Ð²Ð¾Ð´ÑÑ‚ÑÑ?",
    "5) ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð»Ñ‘Ð³ÐºÐ¸Ðµ Ñ‚Ð¾Ð¶Ðµ Ð¾Ñ‚Ð½Ð¾ÑÑÑ‚ÑÑ Ðº Ð¾Ñ€Ð³Ð°Ð½Ð°Ð¼ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ñ?"
]

def render_open():
    st.header("ðŸŸ¨ Ð Ð°Ð·Ð´ÐµÐ»: ÐžÐ¢ÐšÐ Ð«Ð¢Ð«Ð• Ð’ÐžÐŸÐ ÐžÐ¡Ð«")
    st.caption("5 Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð². Ð—Ð° ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐµÐ±Ðµ 0/1/2 Ð±Ð°Ð»Ð»Ð° Ð¿Ð¾ Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÐµ. Ð˜Ñ‚Ð¾Ð³Ð¾ 10 Ð±Ð°Ð»Ð»Ð¾Ð².")

    answers = []
    points = []

    st.info("ÐÐ²Ñ‚Ð¾Ð¾Ñ†ÐµÐ½ÐºÐ°: 2 â€” Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚; 1 â€” Ñ‡Ð°ÑÑ‚Ð¸Ñ‡Ð½Ð¾; 0 â€” Ð½ÐµÑ‚/Ð½Ðµ Ð·Ð½Ð°ÑŽ.")

    for i, q in enumerate(open_questions, start=1):
        text = st.text_area(q, key=f"o{i}", height=90)
        p = st.selectbox(f"Ð‘Ð°Ð»Ð»Ñ‹ Ð·Ð° Ð²Ð¾Ð¿Ñ€Ð¾Ñ {i}", [0, 1, 2], key=f"op{i}")
        answers.append(text.strip() if text else "")
        points.append(int(p))

    score = sum(points)  # 0..10

    # ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ð¿Ð¾ ÑÐ»Ð°Ð±Ñ‹Ð¼ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼
    weak = [str(i+1) for i, p in enumerate(points) if p <= 1]
    if score <= 3:
        comment = "ÐžÑ‚Ð²ÐµÑ‚Ñ‹ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ Ð´Ð¾Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸. ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¸ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹ Ð´Ð¾Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ."
    elif score <= 6:
        comment = "Ð•ÑÑ‚ÑŒ Ð¾ÑÐ½Ð¾Ð²Ð°, Ð½Ð¾ Ð½Ðµ Ñ…Ð²Ð°Ñ‚Ð°ÐµÑ‚ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð¾Ð². Ð”Ð¾Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ñ‹."
    elif score <= 8:
        comment = "Ð¥Ð¾Ñ€Ð¾ÑˆÐ¾. Ð”Ð¾Ð±Ð°Ð²ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹ Ð¸ Ð¾Ð±ÑŠÑÑÐ½ÐµÐ½Ð¸Ð¹ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½/ÑÐ»ÐµÐ´ÑÑ‚Ð²Ð¸Ð¹."
    else:
        comment = "ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾. ÐžÑ‚Ð²ÐµÑ‚Ñ‹ Ñ€Ð°Ð·Ð²ÐµÑ€Ð½ÑƒÑ‚Ñ‹Ðµ Ð¸ Ð¿Ð¾ Ñ‚ÐµÐ¼Ðµ."

    if weak:
        comment += f" Ð’Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹: {', '.join(weak)}."

    return answers, score, comment

# ---------- ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ----------
def send_to_sheet(payload: dict):
    try:
        r = requests.post(SCRIPT_URL, json=payload, timeout=15)
        if r.status_code == 200:
            return True, None
        return False, f"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð¿Ð¸ÑÐ¸: HTTP {r.status_code}"
    except Exception as e:
        return False, str(e)

# Ð Ð•ÐÐ”Ð•Ð  Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ€Ð°Ð·Ð´ÐµÐ»Ð°
if st.session_state.section == "TEST":
    answers, score = render_test()
    comment = comment_by_score(score)
    section_name = "TEST"
else:
    answers, score, comment = render_open()
    section_name = "OPEN"

st.divider()

if st.button("âœ… ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹"):
    if not name.strip() or not klass.strip():
        st.error("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð·Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¤Ð˜Ðž Ð¸ ÐºÐ»Ð°ÑÑ.")
    else:
        payload = {
            "name": name.strip(),
            "klass": klass.strip(),
            "section": section_name,
            "answers": answers,      # Ð²ÑÐµÐ³Ð´Ð° 10 ÑÑ‡ÐµÐµÐº Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ (ÑÐºÑ€Ð¸Ð¿Ñ‚ ÑÐ°Ð¼ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ Ð¿ÑƒÑÑ‚Ñ‹Ð¼Ð¸)
            "score": int(score),     # 0..10
            "comment": comment       # Ð°Ð²Ñ‚Ð¾ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹
        }

        ok, err = send_to_sheet(payload)
        if ok:
            st.success(f"Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! Ð’Ð°Ñˆ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: {score}/10")
            st.info(f"ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹: {comment}")
        else:
            st.warning(f"ÐžÑ‚Ð²ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð½, Ð½Ð¾ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð½Ðµ Ð·Ð°Ð¿Ð¸ÑÐ°Ð»ÑÑ. {err}")
